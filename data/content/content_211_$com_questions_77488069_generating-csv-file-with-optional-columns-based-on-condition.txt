We have a use case where we want to generate a CSV file out of records (can be ~500k). The records are fetched from a db via pagination and converted to a bean collection. Thereafter, the beans are written as rows of CSV file. Sample bean: The problem is that out of the fields in the bean, depending on condition some field might need to be omitted from the CSV. Example: String csvColumns = getCsvColumns() can return: "eventDate,eventId,eventContextId,localeId,description,amount" or "eventDate,eventId,localeId,description,amount" These are actually the required columns for the CSV file. We can assume that these columns can vary depending on client requirement of CSV file, and column list will be available in input request. Queries: How can we achieve customised csv writing with optional columns (e.g. eventContextId is omitted in second example) We have looked into ColumnPositionMappingStrategy , and have tried to write via StatefulBeanToCsv , however we are encountering "NullPointerException" in the StatefulBeanToCsv.write() , which is not apparent. Any help would be appreciated.