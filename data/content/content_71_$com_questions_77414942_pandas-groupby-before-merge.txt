I have dataframe like this. But there are about ten thousand rows. So I need to create column "related_player" based on the player from row which eventId is equal related_eventId. If I would not have column gameId I can do it by merging But output is not correct because I need to group by gameId. In R it is pretty simple, but I don't understand how to correctly do it in Python. My expected output should be like this gameId eventId player related_eventId related_player 1 1 A 2 B 1 2 B 1 A 1 3 C 4 D 1 4 D 3 C 1 5 E NaN NaN 2 1 A 2 B 2 2 B 1 A 2 3 C 4 D 2 4 D 3 C 2 5 E NaN NaN Add column to list ['eventId', 'player','gameId'] and to parameters left_on and right_on :