I would like to combine Cross Validation and Early Stopping Round in LSTM model in Python. I would like to make cross validation on 3 folds and stop learning my LSTM model if for 3 consecutive epchos there is no improvement in the mean AUC of the 3 folds from the cross-validation. In this way, I would like to build a model with the highest possible mean AUC of the 3 folds from cross-validation, which has not improved for 3 epchos in a row. My current code is: How can I modify my code to achieve that ?