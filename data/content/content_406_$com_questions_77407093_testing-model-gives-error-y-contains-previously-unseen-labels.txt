Running the test part the encoded values do not match. For example malaysia should be encoded as 79 but whatever country I put in the test, it encodes as 0 . I am loading the labeldata pickel to transform the test data. How can I adjust it so that the labeling from training phase is applied to the testing phase? The problem is that you are fitting a new LabelEncoder to the test data. To apply the same encoding as in the training phase to the testing data, you should use the transform method of the LabelEncoder you used during training.