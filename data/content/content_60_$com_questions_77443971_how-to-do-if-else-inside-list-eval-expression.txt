I want to perform an if-else transformation for elements in a List series. I use pl.when inside list.eval but encounter a warning message. I have an DataFrame containing a List series, in which the lengths of each row are different: Now I want to perform a if-else transformation on each elements in the List series. More specifically: lambda token: -1 if token == 'unknown' else hash(token) I try to use pl.when inside list.eval expression. It works but raises such warning: The predicate '[(col("")) == (Utf8(__ANY__))]' in 'when->then->otherwise' is not a valid aggregation and might produce a different number of rows than the group_by operation would. This behavior is experimental and may be subject to change What is the proper way to do this?