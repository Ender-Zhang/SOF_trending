I have a function using Polars Expressions to calculate the standard deviation of the residuals from a linear regression (courtesy of this post ). Now I would like to apply this function using a rolling window over a dataframe. My approaches below fail because I don't know how to pass two columns as arguments to the function, since rolling_map() applies to an Expr. Is there a way to do this directly in Polars, or do I need to use a workaround with Pandas? Thank you for your support! (feels like I'm missing something obvious here...) One thing to note about in rolling_map is that it is used for a custom function. While your expression is defined with a function, it isn't what they mean. What they mean is a python function which takes in values and outputs a value. This is also hinted at by the name having map which coincides to map_elements and map_batches . Additionally there's a Warning that it will be extremely slow which also hints at its expectation. To get at what you want to do, you can use rolling which unfortunately doesn't infer an index column so you have to manually create it. It also doesn't accept a UInt as an input so you can't even use with_row_count . Instead do: