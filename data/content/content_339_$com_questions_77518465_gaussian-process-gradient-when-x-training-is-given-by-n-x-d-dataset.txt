I am trying to compute the gradient of a Gaussian Process when the training data set is given by N X D in MATLAB. Where N is the number of data and D is the number of columns. The Python code for computing the gradient is given here. https://stats.stackexchange.com/questions/373446/computing-gradients-via-gaussian-process-regression/479474#479474?newreg=74fa203413cf486a84cb0a4470e6ebdc I implemented the Python code for multiple X and it works well: I have been trying to write similar code in MATLAB as below, without any success: The result is not correct. Does any one have a code for GP gradient in MATLAB?