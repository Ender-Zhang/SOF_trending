In the below code example, if you click the "Deposit money" button and then click "Lock account" quickly before the API call returns, the money still gets deposited. This is because the .then callback is defined using a stale value of accountLocked: false. We could combine the two state variables into one, which would fix this issue, but it doesn't seem like a very robust solution.