two dimension numpi array row may nan want select occurr absenc nan row array per follow prescript row start nan result array row start nan result index last nan continu unbroken sequenc nan start begin row optim way actual work deal numpi array million row exampl let consid array expect result result success code tri would like optim solut add column hstack check valu nan isnan get posit first argmin without concaten use fix case valu nan output