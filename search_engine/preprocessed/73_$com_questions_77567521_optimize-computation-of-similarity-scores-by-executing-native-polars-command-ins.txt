disclaim question support request two user elabor case disclaim ad seen two solut far propos support one util explod function base benchmark whole row data ram liter explod thu test function sampl dataset work accept solut explod method might experi smaller tabl input dataset row dataset imdb movi respect rate user may download csv file load dataset use polar like parent path local server read dataset goal gener cosin similar user user first transform rate tabl row tabl row per user thu run follow queri code snippet group tabl userid comput import metadata specif per user intersect movi seen user seen user thu user movi seen user basic userid movieid length column per user fix length per user result function ask rate target user match index common movi user cosin similar score screenshot tabl give attent column potenti recommend final filter tabl user less equal len movi seen total user tabl input datafram udf function ask question use datafram user want calcul cosin similar user user want compar rate similar movi commonli rate user comput cosin similar among two array rate three udf function use support function benchmark total execut time user minut comput iter per user datafram per user minutess user ram comput polar df user main question transform udf function nativ polar command log custom logger made info comput potenti similar user metadata user info comput similar score user conclud main bottleneck code creat tabl csv load everyth memori return lazyfram instead parquet faster exampl hope make thing simpler replic result filter dataset userid remov timestamp column assum one possibl approach gather need inform lazi api may better strategi parallel work baselin attempt could simpli loop userid duckdb curiou decid check duckdb comparison ram usag run exampl full dataset runtim basic get seem potenti room improv polar side approach came use random df size given dataset think userid movieid uniqu actual dataset put datafram per userid final dictionari concaten addit one big final df want note two column liter movieid given user ad intermedi datafram mr simpl syntax avoid simpli explod gener combin two user filter row match movieid precomput squar rate consid slow one match movi know result save calcul user ad end join gener df took machin second realli sure feasibl full size sure reason solut exist get everi userid combo especi size least nativ polar use numba compil similar function ufunc place directli express without use call addit self join df list intersect stuff use pyarrow parquet writer order write chunk result open file without materi bunch comment line think actual unnecessari given parquet writer comment essenti save bit file tri lessen memori requir play around keep main df lazyfram slow good bit sinc constantli read file comput individu file big memori big join chew lot memori verifi least similar score match result let run minut time user would go even faster write result disk user probabl opportun set write disk accumul user worth result defin mani user depend