setup use model pytorch predict next token use sequenc prior token use vocabulari encod decod model train batch src trg pair tensor length although trg tensor consist one token rest indic ignor loss function problem friend much season ml engin review assign quit sure emb decod input sequenc tri dig question bit seem almost exampl model could find built translat would two differ embed languag decod encod respect model code train script addit model train yield result loss function cross entropi fluctuat tri sever combin hyperparamet includ remov gradient clip avail loss graph