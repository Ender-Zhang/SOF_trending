datafram want creat column c use mask want get last row meet condit creat column c output want look like tri code work instead check cumul sum greater check cumul sum equal maximum cumul sum valu equival get suggest onyambu code demo mask flag last valu satisfi condit use duplic keep last know mask consist valu creat anoth mask flag last occurr valu true chain mask desir mask accomplish flag duplic true except last occurr negat give us want want use chain mask well shorter version answer call idxmax get index highest cum sum although show futurewarn panda point mozway work long least one true valu mask use last index mask true chang valu x revert mask call idxmax get last valu output