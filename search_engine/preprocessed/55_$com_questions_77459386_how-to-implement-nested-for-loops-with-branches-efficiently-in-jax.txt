want reimplement function jax loop array modifi output array index necessarili current iter index base condit current implement via repeat use condit separ function slower numba implement cpu gpu faster suspect due fact iter whole array everi condit numba implement follow current jax reimplement test time output way implement algorithm jax perform compar numba implement way implement jax pretti close recommend ye slower custom numba implement cpu think oper like expect oper defin appli specif logic individu entri array precis comput regim numba design precis kind comput cpu design surpris numba cpu comput fast suspect reason use numba rather numpi numpi design sort algorithm languag languag similar numpi numba languag encod oper across whole array rather choos differ comput benefit comput model becom realli appar move away cpu run code acceler like gpu tpu hardwar specif design vector array oper found code faster gpu