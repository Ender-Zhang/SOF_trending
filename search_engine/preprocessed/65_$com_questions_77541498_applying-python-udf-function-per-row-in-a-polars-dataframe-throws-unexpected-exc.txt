follow polar df python want creat new column name take rate list index movi rate common movi exampl first row return rate movi second row rate movi forth reason creat follow function final appli udf function datafram like everi time appli function receiv follow error expect tupl got list also tri differ approach udf function like iter receiv error updat data input scenario scope went wrong approach ignor perform penalti python udf two thing went wrong approach appli context tri use expect output tupl element tupl output column function output tupl chang return line return output tupl work ca add column polar datafram squar bracket notat thing left side df never df someth use old version allow part new version allow mean someth like case ad column exist df use use hstack like realli use etc nativ approach could work slower less effici scroll bottom approach nativ solut preambl assum list alway long could note gener indic list loop rang length list n item associ n th posit n put indic list unfortun like method polar list type column without explod list best way think creat indic list nativ solut answer polar ca recurs set need manual use lazi evalu faster approach comput case parallel convert lazi first part concat allow frame calcul parallel frame subset base length list also allow indic becom cser mean calcul even though refer incident less code could simpli set preambl section run rest section approach much slower one everi row iter element max list length add unnecessari check also get parallel word work fewer cpu core work benchmark fake data creation method thread ms per loop mean std dev run loop method thread ms per loop mean std dev run loop method thread ms per loop mean std dev run loop jquriou ms per loop mean std dev run loop ms per loop mean std dev run loop preambl big per loop mean std dev run loop method use gb ram explodi one closer gb struct instead use imo realli clunki instead use clunki often need wrap input struct add column cleanli reli column posit instanc defin function use follow happen invok singl column custom function need multipl input wrap struct struct get turn dict key name column approach inher perform benefit rel imo better syntax lastli jquriou mention comment answer could almost certainli streamlin term syntax perform incorpor logic format list word step step question guess happen step like combin two step would worthwhil endeavor updat approach use less memori slightli slower mention comment though share exampl start dataset like done much simpler fashion perform task describ nativ without udf essenti need reshap data use polar function keep match row