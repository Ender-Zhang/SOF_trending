code exampl click deposit money button click lock account quickli api call return money still get deposit even though account lock code sandbox callback defin use stale valu accountlock fals read latest correct valu accountlock true canon way ensur latest state react async code could combin two state variabl one would fix issu seem like robust solut could also consid make ref track latest valu accountlock also seem duplic confus ref state refer valu link relat question retriev current state insid async function think question simpler gener exampl provid answer valu accountlock set lock ondepositmoney defin basic way curri work want access current valu accountlock need use mutabl object whose content chang ref react set ref updat state valu accountlock even though two addit line write custom hook make pattern easier use contain like would use like approach work asynchron code well like useeffect settimeout one thing note custom hook approach eslint requir includ ref accountlockedref depend array hook useeffect usecallback effect valu ref stabl eslint ca tell idea could also combin state avoid annoy read effect ref purist could argu piec state belong togeth person pragmat purist simplest idea stop user perform action api call progress